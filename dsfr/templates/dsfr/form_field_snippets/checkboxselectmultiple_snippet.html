{% load widget_tweaks dsfr_tags %}
<fieldset class="fr-fieldset{% if field.errors %} fr-fieldset--error{% endif %}"
          id="checkboxes-{{ field.auto_id }}"
          aria-labelledby="{{ field.auto_id }}-legend{% if field.errors %} {{ field.auto_id }}-messages{% endif %}">
  <legend class="fr-fieldset__legend fr-text--regular"
          id="{{ field.auto_id }}-legend">
    {{ field.label_tag }}
    {% if field.field.required %}
      *
    {% endif %}
    {% if field.help_text %}
      <span class="fr-hint-text">{{ field.help_text }}</span>
    {% endif %}
  </legend>
  <div class="fr-fieldset__content">
    <div class="fr-checkbox-group{% if field.errors %} fr-checkbox-group--error{% endif %}{% if field.field.disabled %} fr-input-group--disabled{% endif %}">
      {% if field.errors %}
        {% with aria_describedby="aria-describedby:"|add:field.auto_id|add:"-desc-error" %}
          {{ field|dsfr_input_class_attr|attr:"type:checkbox"|attr:aria_describedby }}
        {% endwith %}
      {% else %}
        {{ field|dsfr_input_class_attr|attr:"type:checkbox" }}
      {% endif %}
      {% if field.errors %}
        <div id="{{ field.auto_id }}-desc-error" class="fr-error-text">
          {{ field.errors }}
        </div>
      {% endif %}
    </div>
  </div>
  {% if field.errors %}
    <div id="{{ field.auto_id }}-messages">
      {{ field.errors }}
    </div>
  {% endif %}
</fieldset>
