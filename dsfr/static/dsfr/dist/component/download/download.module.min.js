/*! DSFR v1.9.2 | SPDX-License-Identifier: MIT | License-Filename: LICENSE.md | restricted use (see terms and conditions) */
const t=window.dsfr,e={DOWNLOAD_ASSESS_FILE:`${t.internals.ns.attr.selector("assess-file")}`,DOWNLOAD_DETAIL:`${t.internals.ns.selector("download__detail")}`};class s extends t.core.Instance{static get instanceClassName(){return"AssessFile"}init(){this.lang=this.getLang(this.node),this.href=this.getAttribute("href"),this.hreflang=this.getAttribute("hreflang"),this.file={},this.detail=this.querySelector(e.DOWNLOAD_DETAIL),this.update()}getFileLength(){void 0!==this.href?fetch(this.href,{method:"HEAD",mode:"cors"}).then((e=>{this.length=e.headers.get("content-length")||-1,-1===this.length&&t.inspector.warn("File size unknown: "+this.href+'\nUnable to get HTTP header: "content-length"'),this.update()})):this.length=-1}update(){if(this.isLegacy&&(this.length=-1),!this.length)return void this.getFileLength();const t=[];if(this.detail){if(this.href){const e=this.parseExtension(this.href);e&&t.push(e.toUpperCase())}-1!==this.length&&t.push(this.bytesToSize(this.length)),this.hreflang&&t.push(this.getLangDisplayName(this.hreflang)),this.detail.innerHTML=t.join(" - ")}}getLang(t){return t.lang?t.lang:document.documentElement===t?window.navigator.language:this.getLang(t.parentElement)}parseExtension(t){return t.match(/\.(\w{1,9})(?:$|[?#])/)[0].replace(".","")}getLangDisplayName(t){if(this.isLegacy)return t;const e=new Intl.DisplayNames([this.lang],{type:"language"}).of(t);return e.charAt(0).toUpperCase()+e.slice(1)}bytesToSize(e){if(-1===e)return null;let s=["octets","ko","Mo","Go","To"];"bytes"===this.getAttribute(t.internals.ns.attr("assess-file"))&&(s=["bytes","KB","MB","GB","TB"]);const n=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);if(0===n)return`${e} ${s[n]}`;const i=e/1e3**n,h=Math.round(100*(i+Number.EPSILON))/100;return`${String(h).replace(".",",")} ${s[n]}`}}t.download={DownloadSelector:e,AssessFile:s},t.internals.register(t.download.DownloadSelector.DOWNLOAD_ASSESS_FILE,t.download.AssessFile);
